#!/usr/bin/env node

// Example: npm-sync --store.engine=Memory --concurrency=5

var options = require('optimist').argv,
    monitor = require('..');

if (options.store) {
  var clazz;
  if (options.store.module) {
    clazz = require(options.store.module);
  } else if (options.store.engine) {
    clazz = monitor.store[options.store.engine];
  } else {
    clazz = monitor.store.Redis;
  }
  if (!clazz) {
    throw new Error('Invalid store: not found');
  }
  options.store = new clazz(options.store.options);
}

require('../')(options);
